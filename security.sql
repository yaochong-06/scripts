-- Name:
--   security.sql
-- Copyright:
--   alibaba.com (c)
-- Note:
--   called by scanflaw.pl
-- Modification:
--   Rudolf Lu       2004/12/01     created

/*
  This script shows warnings and information relating to security such as password,user privileges
  For daily administration,not for consultant 
*/

connect / as sysdba
set lines 100
set pages 10000
set heading on
set feedback off
col profile  format a20
col limit format a20

prompt 
prompt If the following query returns no rows, that means OK.
prompt =====================================================
prompt 
prompt The following privs may be revoke from Role PUBLIC
prompt ================
select grantee, table_name "object name" from TABLE_PRIVILEGES
  where table_name in (
    'UTL_SMTP',
    'UTL_TCP',	
    'UTL_HTTP',
    'DBMS_FLASHBACK',
    'DBMS_OBFUSCATION_TOOLKIT',
    'DBMS_METADATA',
    'DBMS_JOB',
    'DBMS_RANDOM')
  and grantee = 'PUBLIC';

prompt
prompt Parameters not properly set
prompt ================
select name,value from v$parameter2
where  ( name = 'OS_ROLES' and value = 'FALSE' )
   or (name = 'REMOTE_OS_ROLES'             and value <> 'FALSE' )
   or (name = 'SQL92_SECURITY'              and value <> 'TRUE' )
   or (name = 'DBLINK_ENCRYPT_LOGIN'        and value <> 'TRUE' )
   or (name = 'ORA_ENCRYPT_LOGIN'           and value <> 'TRUE' )
   or (name = 'O7_DICTIONARY_ACCESSIBILITY' and value <> 'FALSE' )
   or (name = 'REMOTE_OS_AUTHENT'           and value <> 'FALSE' );

prompt   
prompt Users out of allowable list
prompt ================
select username,CREATED as  from dba_users
  where username not in ('SYS','SYSTEM','OPS$ADMIN','PERFSTAT','RMAN',
            'ALIBABA','NIRVANA','RND','MIRROR','PSALES2')
    and ACCOUNT_STATUS not like '%LOCKED';

prompt
prompt Checking password policy
prompt ================
select profile,resource_name,limit from dba_profiles
  where limit in ('UNLIMITED','NULL')
    and resource_type = 'PASSWORD'
    and resource_name <> 'PASSWORD_REUSE_MAX';
    
prompt
prompt Users have weak password 
prompt ================
select username, created  from dba_users
  where ACCOUNT_STATUS not like '%LOCKED'
    and password in 
('',
'009BBE8142502E10',
'00A12CC6EBF8EDB8',
'021B05DBB892D11F',
'0273F484CD3F44B7',
'02AB2DB93C952A8F',
'03B20D2C323D0BFE',
'04071E7EDEB2F5CC',
'0447F2F756B4F460',
'0478B8F047DECC65',
'0487AFEE55ECEE66',
'049B2397FB1A419E',
'05327CD9F6114E21',
'05A92C0958AFBCBC',
'05BFA7FF86D6EB32',
'061354246A45BBAB',
'063BA85BF749DF8E',
'066A2E3072C1F2F3',
'09B4BB013FBD0D65',
'0A30645183812087',
'0A6B2DF907484CEE',
'0A8303530E86FCDD',
'0AD9ABABC74B3057',
'0B4409DDD5688913',
'0BD475D5BF449C63',
'0C0832F8B6897321',
'0D5C9EFC2DFE52BA',
'0D9D14FE6653CF69',
'0D9EC1D1F2A37657',
'0DABFF67E0D33623',
'0E0F7C1B1FE3FA32',
'0E7260738FDFD678',
'0EF5997DC2638A61',
'0F886772980B8C79',
'0FAA06DA0F42F21F',
'106AE118841A5D8C',
'10A40A72991DCA15',
'10B0C2DA37E11872',
'11E0654A7068559C',
'123CF56E05D4EF3C',
'12CFB5AE1D087BA3',
'133F8D161296CB8F',
'135176FFB5BA07C9',
'137CEDC20DE69F71',
'144441CEBAFC91CF',
'147215F51929A6E8',
'169018EB8E2C4A77',
'1718E5DBB8F89784',
'1729F80C5FA78841',
'1740079EFF46AB81',
'17DC8E02BC75C141',
'183AC2094A6BD59F',
'1848F0A31D1C5C62',
'18A0C8BD6B13BEE2',
'18F0B0E50B9F7B12',
'1AB4E5FD2217F7AA',
'1AF71599EDACFB00',
'1B9F1F9A5CB9EB31',
'1BF23812A0AEEDA0',
'1CE0B71B4A34904B',
'1DF0D45B58E72097',
'1E2F06BE2A1D41A6',
'1EF8D8BD87CF16BE',
'1FA22316B703EBDD',
'1FF89109F7A16FEF',
'203CD8CF183E716C',
'20E788F9D4F1D92C',
'21A837D0AED8F8E5',
'21FBCADAEAFCC489',
'2485287AC1DB6756',
'24ABAB8B06281B4C',
'24ACF617DD7D8F2F',
'2563EFAAE44E785A',
'2564B34BE50C2524',
'26ED9DD4450DD33C',
'28D778112C63CB15',
'28EE1E024FC55E66',
'2905ECA56A830226',
'2907B1BFA9DA5091',
'29268859446F5A8C',
'29802572EB547DBF',
'29ECA1F239B0F7DF',
'29ED3FDC733DC86D',
'2A8ED59E27D86D41',
'2AB40F104D8517A0',
'2AB9032E4483FAFC',
'2B0C31040A1CFB48',
'2C3A5DEF1EE57E92',
'2C5ECE3BEC35CE69',
'2CA6D0FC25128CF3',
'2D4B13A8416073A1',
'2D594E86F93B17A1',
'2E175141BEE66FF6',
'2E3EA470A4CA2D94',
'2ED539F71B4AA697',
'2F11631B6B4E0B6F',
'2FB4D2C9BAE2CCCA',
'2FFDCBB4FD11D9DC',
'30802533ADACFE14',
'313F9DFD92922CD2',
'31C1DDF4D5D63FE6',
'333B8121593F96FB',
'33C2E27CF5E401A4',
'33EBE1C63D5B7FEF',
'34200F94830271A3',
'3522F32DD32A9706',
'355CBEC355C10FEF',
'35EC0362643ADD3F',
'373F527DC0CFAE98',
'37A99698752A1CF1',
'37EF7B2DD17279B5',
'380E3D3AD5CE32D4',
'38379FC3621F7DA2',
'38BC87EB334A1AC4',
'38E38619A12E0257',
'397129246919E8DA',
'3990FB418162F2A0',
'3A34F0B26B951F3F',
'3AA26FC267C5F577',
'3B3F6DB781927D0F',
'3BAA3289DB35813C',
'3C6B8C73DDC6B04F',
'3CBED37697EB01D1',
'3D1FB783F96D1F5E',
'3D703795F61E3A9A',
'3D9B7E34A4F7D4E9',
'3DA1893A5FCA23BF',
'3DD36935EAEDE2E3',
'3DE1EBA32154C56B',
'3E7B4116043BEAFF',
'3E9C94488C1A3908',
'3F9FBD883D787341',
'3FB8EF9DB538647C',
'402B659C15EAF6CB',
'404B03707BF5CEA3',
'4087EE6EB7F9CD7C',
'41B328CA13F70713',
'41C2D31F3C85A79D',
'42068201613CA6E2',
'43BE121A2A135FF3',
'4438308EE0CAFB7F',
'447B729161192C24',
'450793ACFCC7B58E',
'4553A3B443FB3207',
'4603BCD2744BDE4F',
'4646116A123897CF',
'46DC27700F2ADE28',
'46DFFB4D08C33739',
'4782D68D42792139',
'4861C2264FB17936',
'489B61E488094A8D',
'49A3A09B8FC291D0',
'49B70B505DF0247F',
'4A0A55000357BB3E',
'4A3BA55E08595C81',
'4B16ACDA351B557D',
'4C3F880EFA364016',
'4C59B97125B6641A',
'4C6D73C3E8B0F0DA',
'4CB05AA42D8E3A47',
'4CEA0BF02214DA55',
'4CF13BDAC1D7511C',
'4DE42795E66117AE',
'4EA68D0DDE8AAC6B',
'4F9FFB093F909574',
'4FE07360D435E2F0',
'50D22B9D18547CF7',
'51063C47AC2628D4',
'5140E342712061DD',
'545E13456B7DDEA0',
'54A85D2A0AB8D865',
'54B253CBBAAA8C48',
'5638228DAF52805F',
'564F871D61369A39',
'56DB3E89EAE5788E',
'5746C5E077719DB4',
'5787B0D15766ADFD',
'57D7CFA12BB5BABF',
'57F2A93832685ADB',
'58872B4319A76363',
'58C823BA7A2D3D7F',
'59BBED977430C1A8',
'5A40D4065B3673D2',
'5A4EEC421DE68DDD',
'5A88CE52084E9700',
'5AC333703DE0DBD4',
'5C1AED4D1AADAA4C',
'5C3546B4F9165300',
'5C5F6FC2EBB94124',
'5CA8F5380C959CA9',
'5D0E790B9E882230',
'5D85C7E8FB28375F',
'5DCD6E2E26D33A6E',
'5F1869AD455BBA73',
'6026F9A8A54B9468',
'604101D3AACE7E88',
'6102BAE530DD4B95',
'611E7A73EC4B425A',
'62876B0382D5B550',
'62FADF01C4DC1ED4',
'635074B4416CD3AC',
'637417B1DC47C2E5',
'6399F3B38EDF3288',
'639C32A115D2CA57',
'63BB534256053305',
'63BF5FFE5E3EA16D',
'64074AF827F4B74A',
'6465913FF5FF1831',
'652C49CDF955F83A',
'6658C384B8D63B0A',
'66A490AEAA61FF72',
'66BC3FF56063CE97',
'66F4EF5650C20355',
'67B891F114BE3AEB',
'684E28B3C899D42C',
'685657E9DC29E185',
'6869F3CFD027983A',
'691C5E7E424B821A',
'69C27FA786BA774C',
'69CB07E2162C6C93',
'69ED49EE1851900D',
'6A066C462B62DD46',
'6A10DD2DB23880CB',
'6A29482069E23675',
'6B870AF28F711204',
'6CBBF17292A1B9AA',
'6CC978F56D21258D',
'6CFF570939041278',
'6D79A2259D5B4B5A',
'6DE993A60BC8DBBF',
'6E0C251EABE4EBB8',
'6E204632EC7CA65D',
'6E97FCEA92BAA4CB',
'6F6675F272217CF7',
'707156934A6318D4',
'70C3248DFFB90152',
'71452E4797DF917B',
'71B5C2271B7CFF18',
'71C2B12C28B79294',
'71E687F036AD56E5',
'723007181C44715C',
'72979A94BAD2AF80',
'7299A5E2A5A05820',
'72A90A786AAE2914',
'72CDEF4A3483F60D',
'72E382A52E89575A',
'739F5BC33AC03043',
'73A3AC32826558AE',
'73E3EC9C0D1FAECF',
'73EAE7C39B42EA15',
'73F284637A54777D',
'7404A12072F4E5E8',
'74085BE8A9CF16B4',
'750F2B109F49CC13',
'76224BCC80895D3D',
'7653EBAF048F0A10',
'76B8D54A74465BB4',
'76F373437F33F347',
'7766E887AF4DCC46',
'78194639B5C3DF9F',
'783E58C29D2FC7E1',
'7910AE63C9F7EEEE',
'79DF7A1BD138CF11',
'7A0F2B316C212D67',
'7AA1A84E31ED7771',
'7AAFE7D01511D73F',
'7ABBCF4BEB7854B2',
'7AF870D89CABF1C7',
'7B83A0860CF3CB71',
'7BB2F629772BF2E5',
'7C0900F751723768',
'7C0BE475D580FBA2',
'7C632AFB71F8D305',
'7C9BA362F8314299',
'7CA0A42DA768F96D',
'7E15FBACA7CDEBEC',
'7E2C3C2D4BF4071B',
'7E9901882E5F3565',
'7EFA02EC7EA6B86F',
'80294AE45A46E77B',
'80C099F0EADF877E',
'811C49394C921D66',
'81F2423D6811246D',
'82542940B0CF9C16',
'82959A9BD2D51297',
'82E7FF841BFEAB6C',
'840267B7BD30C82E',
'84B8CBCA4D477FA3',
'855296220C095810',
'86FDB286770CD4B9',
'870C36D8E6CD7CF5',
'87470D6CE203FB4D',
'8765D2543274B42E',
'87DADF57B623B777',
'882B80B587FCDBC8',
'888203D36F64C5F6',
'88A2B2C183431F00',
'88D8364765FCE6AF',
'88D8F06915B1FE30',
'89804494ADFC71BC',
'89A8C104725367B2',
'8A0760E2710AB0B4',
'8A43574EFB1C71C7',
'8A8F025737A9097A',
'8AA1C62E08C76445',
'8B09C6075BDF2DC4',
'8B104568E259B370',
'8BF0DA8E551DE1B9',
'8C69D50E9D92B9D0',
'8CE2703752DB36D8',
'8CF13718CDC81090',
'8E2713F53A3D69D5',
'8FB1DC9A6F8CE827',
'8FCB78BBA8A59515',
'905475E949CF2703',
'907D70C0891A85B1',
'90C4F894E2972F08',
'915C93F34954F5F8',
'91792EFFCB2464F9',
'91A00922D8C0F146',
'92776EA17B8B5555',
'9300C0977D7DC75E',
'933B9A9475E882A6',
'94152F9F5B35B103',
'9435F2E60569158E',
'9671866348E03616',
'9699CFD34358A7A7',
'969F9C3839672C6D',
'96AE343CA71895DA',
'970B962D942D0C75',
'970BAA5B81930A40',
'9793B3777CD3BD1A',
'97FD0AE6DFF0F5FE',
'98741BDA2AC7FFB2',
'991C817E5FD0F35A',
'991CDDAD5C5C32CA',
'99355BF0E53FF635',
'9A2A7E2EBE6E4F71',
'9A5F2D9F5D1A9EF4',
'9A7DCB0C1D84C488',
'9AC2B58153C23F3D',
'9B616F5489F90AD7',
'9B667E9C5A0D21A6',
'9B95D28A979CC5C4',
'9C30855E7E0CB02D',
'9C4F452058285A74',
'9D1F407F3A05BDD9',
'9D41D2B3DD095227',
'9D561E4D6585824B',
'9DCE98CCF541AAE6',
'9E3C81574654100A',
'A01A5F0698FC9E31',
'A07F1956E3E468E1',
'A0A3A6A577A931A3',
'A0E2085176E05C85',
'A13C035631643BA0',
'A219FE4CA25023AA',
'A2A1265A6BDC8F36',
'A410B2C5A0958CDF',
'A43EE9629FA90CAE',
'A5E09E84EC486FC9',
'A68F56FBBCDC04AB',
'A695699F0F71C300',
'A7A32CD03D3CE8D5',
'A7F7978B21A6F65E',
'A8116DB6E84FA95D',
'A97282CE3D94E29E',
'A98B26E2F65CA4D3',
'A9A57E819B32A03D',
'AA2602921607EE84',
'AA3CB2A4D9188DDB',
'AA71234EF06CE6B3',
'AAA18B5D51B0D5AC',
'AB27B53EDC5FEF41',
'ABFEC5AC2274E54D',
'AC9700FD3F1410EB',
'AC98877DE1297365',
'ACBD635B3A25405D',
'ACEAB015589CF4BC',
'AD0D93891AEB26D2',
'AD7862E01FA80912',
'ADBC95D8DCC69E66',
'AE128772645F6709',
'AE62CB8167819595',
'AEBEDBB4EFB5225B',
'AF52CFD036E8F425',
'Anonymous',
'B064872E7F344CAE',
'B1344DC1B5F3D903',
'B171042374D7E6A2',
'B2F0E221F45A228F',
'B39565F4E3CF744B',
'B40C23C6E2B4EA3D',
'B41BCD9D3737F5C4',
'B45D4DF02D4E0C85',
'B49C4279EBD8D1A8',
'B516D9A33679F56B',
'B650B1BB35E86863',
'B6FD427D08619EEE',
'B7C1BB95646C16FE',
'B8527562E504BC3F',
'B8B15AC9A946886A',
'B97545C4DD2ABE54',
'B9E99443032F059D',
'BA3E855E93B5B9B0',
'BA787E988F8BC424',
'BAEF9D34973EE4EC',
'BB0E28666845FCDC',
'BB424460EFEC9080',
'BBBFE175688DED7E',
'BBE7786A584F9103',
'BBFF58334CDEF86D',
'BD63D79ADF5262E7',
'BD821F59270E5F34',
'BD8EA41168F6C664',
'BD99EC2DD84E3B5C',
'BDE248D4CCCD015D',
'BE29E31B2B0EDA33',
'BE89B24F9F8231A9',
'BEA52A368C31B86F',
'BEAA1036A464F9F0',
'BF24BCE2409BE1F7',
'BFBA5A553FD9E28A',
'C03082CD3B13EC42',
'C04057049DF974C2',
'C09011CB0205B347',
'C0A0F776EBBBB7FB',
'C1510E7AC8F0D90D',
'C1959B03F36C9BB2',
'C252E8FA117AF049',
'C2B4C76AB8257DF5',
'C35109FE764ED61E',
'C37E732953A8ABDB',
'C42D1FA3231AB025',
'C4522E109BCF69D0',
'C4D7FE062EFB85AB',
'C5D5C455A1DE5F4D',
'C5F0512A64EB0E7F',
'C69573E9DEC14D50',
'C6AF8FCA0B51B32F',
'C6E799A949471F57',
'C6EED68A8F75F5D3',
'C789210ACC24DA16',
'C7A235E6D2AF6018',
'C7AEAA2D59EB1EAE',
'C7D0B9CDE0B42C73',
'C909E4F104002876',
'C9B597D7361EE067',
'C9D53D00FE77D813',
'CA39F929AF0A2DEC',
'CA5D67CD878AFC49',
'CAC22318F162D597',
'CB4F2CEC5A352488',
'CB562C240E871070',
'CB6B5E9D9672FE89',
'CB7B2E6FFDD7976F',
'CD6E99DACE4EA3A6',
'CE4A36B8E06CA59C',
'CE8234D92FCFB563',
'CEAE780F25D556F8',
'CEE2C4B59E7567A3',
'CF39DE29C08F71B9',
'CF5A081E7585936B',
'CF95D2C6C85FF513',
'CF9CB787BD98DA7F',
'CF9CFACF5AE24964',
'CFD1302A7F832068',
'D0EFCD03C95DF106',
'D0F2982F121C7840',
'D148049C2780B869',
'D1A2DFC623FDA40A',
'D1FB757B6E3D8E2F',
'D27FA6297C0313F4',
'D2E3EF40EE87221E',
'D326D25AE0A0355C',
'D33CEB8277F25346',
'D373ABE86992BE68',
'D38D161C22345902',
'D40D0FEF9C8DC624',
'D4C4DCDD41B05A5D',
'D4C5016086B2DC6A',
'D4D76D217B02BD7A',
'D4DF7931AB130E37',
'D5DB40BB03EA1270',
'D5DD57A09A63AA38',
'D664AAB21CE86FD2',
'D6DF5BBC8B64933E',
'D728438E8A5925E0',
'D7837F182995E381',
'D7C18B3B3F2A4D4B',
'D89D6F9EB78FC841',
'D8CC61E8F42537DA',
'D8FF6ECEF4C50809',
'D90F98746B68E6CA',
'DA4435BBF8CAE54C',
'DAF602231281B5AC',
'DB78866145D4E1C3',
'DC7948E807DFE242',
'DC86E8DEAA619C1A',
'DD58348364219102',
'DE5B73C964C7B67D',
'DEF637F1D23C0C59',
'DF02A496267DEE66',
'E066D214D5421CCC',
'E079BF5E433F0B89',
'E0BF7F3DDE682D3B',
'E153FFF4DAE6C9F7',
'E1BAE6D95AA95F1E',
'E269165256F22F01',
'E39CEFE64B73B308',
'E3B6E6006B3A99E0',
'E3D0DCF4B4DBE626',
'E4519FCD3A565446',
'E462DB4671A51CD4',
'E4AAF998653C9A72',
'E5288E225588D11F',
'E53F7C782FAA6898',
'E5436F7169B29E4D',
'E654261035504804',
'E6A6FA4BB042E3C2',
'E74B15A3F7A19CA8',
'E7683741B91AF226',
'E7686462E8CD2F5E',
'E7B5D92911C831E1',
'E7FDFE26A524FE39',
'E84CC95CBBAC1B67',
'E93196E9196653F1',
'E9473A88A4DD31F2',
'EA514DD74D7DE14C',
'EAA333E83BF2810D',
'EB265A08759A15B4',
'EB50644BE27DF70B',
'EC481FD7DCE6366A',
'ED4CDE954630FA82',
'EDECA9762A8C79CD',
'EE02531A80D998CA',
'EED09A552944B6AD',
'F05E53C662835FA2',
'F0EB74546E22E94D',
'F13FF949563EAB3C',
'F165BDE5462AD557',
'F239A50072154BAC',
'F2C3DC8003BC90F8',
'F339612C73D27861',
'F3701A008AA578CF',
'F483A48F6A8C51EC',
'F4F306B7AEB5B6FC',
'F55561567EF71890',
'F5AB0AA3197AEE42',
'F5E498AC7009A217',
'F67E035BF8352CB4',
'F7101600ACABCD74',
'F712D80109E3C9D8',
'F73E1A76B1E57F3D',
'F74F7EF36A124931',
'F8841A7B16302DE6',
'F894844C34402B67',
'F9DA8977092B7B81',
'F9ED601D936158BD',
'F9FDEB0DE52F5D6B',
'FAAD7ADAF48B5F45',
'FABA49C38150455E',
'FBB3209FD6280E69',
'FC1B0DD35E790847',
'FD0C7DB4C69FA642',
'FD621020564A4978',
'FDFE8B904875643D',
'FE0E8CE7C92504E9',
'FE84888987A6BF5A',
'FF09F3EB14AE5C26',
'FF4B266F9E61F911',
'FFDF6A0C8C96E676',
'INVALID_ENCRYPTED_PASSWORD') ;

exit
